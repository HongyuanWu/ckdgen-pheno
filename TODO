TODO

- residual generation (if necessary)
